# üöÄ Guide d'Optimisation des Performances - OMA Digital

## üìä Probl√®mes Identifi√©s (Lighthouse)

### Performance Actuelle
- **Performance Score**: 10/100
- **FCP (First Contentful Paint)**: 1.0s ‚úÖ
- **LCP (Largest Contentful Paint)**: 31.8s ‚ùå (Cible: <2.5s)
- **TBT (Total Blocking Time)**: 10,370ms ‚ùå (Cible: <200ms)
- **CLS (Cumulative Layout Shift)**: 0 ‚úÖ
- **Speed Index**: 14.2s ‚ùå (Cible: <3.4s)

### Probl√®mes Majeurs
1. **JavaScript √©norme**: 14.3s d'ex√©cution
2. **Bundles trop gros**: 4,273 KiB de payload r√©seau
3. **Lucide-react**: Trop d'ic√¥nes import√©es (422 KiB non utilis√©s)
4. **Google Tag Manager**: 141 KiB bloquant le rendu
5. **Framer Motion**: 328 KiB (animations lourdes)
6. **React-DOM Development**: 604 KiB (mode dev au lieu de prod)

## ‚úÖ Optimisations D√©j√† Impl√©ment√©es

### 1. SEO Am√©lior√© ‚úÖ
- ‚úÖ Ajout de `<title>` et `<meta description>` sur `/about`
- ‚úÖ Meta tags Open Graph et Twitter Card
- ‚úÖ Canonical URLs
- ‚úÖ Mots-cl√©s optimis√©s pour S√©n√©gal et Maroc
- ‚úÖ Geo-tags pour Dakar, Thies, Casablanca, Rabat, Marrakech
- ‚úÖ Contact info mis √† jour (+212701193811)

### 2. Fichiers d'Optimisation Cr√©√©s ‚úÖ
- ‚úÖ `src/lib/icons.ts` - Exports optimis√©s de lucide-react
- ‚úÖ `src/components/OptimizedGTM.tsx` - GTM charg√© en async
- ‚úÖ Configuration SEO compl√®te dans `src/lib/seo-config.ts`

## üîß Actions √† Effectuer Maintenant

### √âTAPE 1: Build en Mode Production
```bash
# Assurez-vous de builder en mode production
npm run build
npm start

# V√©rifiez que NODE_ENV=production
```

### √âTAPE 2: Optimiser les Imports de Lucide-React
Remplacer tous les imports directs par le fichier centralis√©:

**‚ùå Avant:**
```typescript
import { Menu, X, Phone } from 'lucide-react';
```

**‚úÖ Apr√®s:**
```typescript
import { Menu, X, Phone } from '../lib/icons';
```

**Fichiers √† modifier:**
- `src/components/Header.tsx`
- `src/components/Footer.tsx`
- `src/components/HeroSection.tsx`
- `src/components/ServicesSection.tsx`
- `src/components/TestimonialsSection.tsx`
- Tous les composants dans `src/components/SmartChatbot/`

### √âTAPE 3: Lazy Loading des Composants Lourds

**Modifier `pages/index.tsx`:**
```typescript
import dynamic from 'next/dynamic';

// Lazy load des sections non critiques
const TestimonialsSection = dynamic(() => import('../src/components/TestimonialsSection').then(mod => ({ default: mod.TestimonialsSection })), {
  loading: () => <div className="h-96 bg-gray-50 animate-pulse" />,
  ssr: false
});

const ProcessTimeline = dynamic(() => import('../src/components/ProcessTimeline').then(mod => ({ default: mod.ProcessTimeline })), {
  loading: () => <div className="h-96 bg-gray-50 animate-pulse" />,
  ssr: false
});

const SmartChatbot = dynamic(() => import('../src/components/SmartChatbot'), {
  loading: () => null,
  ssr: false
});
```

### √âTAPE 4: Optimiser Framer Motion

**Cr√©er `src/lib/motion.ts`:**
```typescript
// Import uniquement les fonctions n√©cessaires
export { motion } from 'framer-motion';
export { useInView } from 'framer-motion';
export { AnimatePresence } from 'framer-motion';
```

**Remplacer:**
```typescript
// ‚ùå Avant
import { motion, useInView, AnimatePresence } from 'framer-motion';

// ‚úÖ Apr√®s
import { motion, useInView, AnimatePresence } from '../lib/motion';
```

### √âTAPE 5: Code Splitting Avanc√©

**Modifier `next.config.js`:**
```javascript
webpack: (config, { isServer }) => {
  if (!isServer) {
    config.optimization.splitChunks = {
      chunks: 'all',
      cacheGroups: {
        // S√©parer les vendors lourds
        framerMotion: {
          test: /[\\/]node_modules[\\/]framer-motion[\\/]/,
          name: 'framer-motion',
          priority: 30,
          reuseExistingChunk: true,
        },
        lucideReact: {
          test: /[\\/]node_modules[\\/]lucide-react[\\/]/,
          name: 'lucide-react',
          priority: 25,
          reuseExistingChunk: true,
        },
        supabase: {
          test: /[\\/]node_modules[\\/]@supabase[\\/]/,
          name: 'supabase',
          priority: 20,
          reuseExistingChunk: true,
        },
        vendor: {
          test: /[\\/]node_modules[\\/]/,
          name: 'vendors',
          priority: 10,
          maxSize: 200000, // 200KB max
        },
      },
    };
  }
  return config;
},
```

### √âTAPE 6: Pr√©charger les Ressources Critiques

**Ajouter dans `pages/_document.tsx`:**
```typescript
<Head>
  {/* Pr√©charger les polices */}
  <link rel="preload" href="/fonts/inter-var.woff2" as="font" type="font/woff2" crossOrigin="anonymous" />
  
  {/* Pr√©charger le logo */}
  <link rel="preload" href="/images/logo.webp" as="image" />
  
  {/* DNS Prefetch */}
  <link rel="dns-prefetch" href="//fonts.googleapis.com" />
  <link rel="dns-prefetch" href="//www.googletagmanager.com" />
</Head>
```

### √âTAPE 7: Optimiser les Images

**Utiliser next/image partout:**
```typescript
// ‚ùå √âviter
<img src="/images/hero.jpg" alt="Hero" />

// ‚úÖ Utiliser
import Image from 'next/image';
<Image 
  src="/images/hero.jpg" 
  alt="Hero"
  width={1200}
  height={600}
  priority // Pour les images above-the-fold
  quality={85}
  placeholder="blur"
/>
```

### √âTAPE 8: Supprimer le Code Inutilis√©

**Analyser le bundle:**
```bash
ANALYZE=true npm run build
```

**Supprimer:**
- Composants de test non utilis√©s
- Imports inutilis√©s
- Code mort (dead code)

### √âTAPE 9: Configurer la Compression

**Ajouter dans `next.config.js`:**
```javascript
compress: true,
productionBrowserSourceMaps: false, // D√©sactiver les source maps en prod
```

### √âTAPE 10: Cache HTTP Agressif

**Headers d√©j√† configur√©s dans `next.config.js` ‚úÖ**
- Static assets: 1 an de cache
- Images: Cache immutable
- API: No-cache

## üìà R√©sultats Attendus

Apr√®s ces optimisations:
- **Performance Score**: 90+ (actuellement 10)
- **LCP**: <2.5s (actuellement 31.8s)
- **TBT**: <200ms (actuellement 10,370ms)
- **Bundle Size**: -60% (de 4.3MB √† ~1.7MB)
- **JavaScript Execution**: -70% (de 14.3s √† ~4s)

## üéØ Priorit√©s Imm√©diates

1. **URGENT**: Build en mode production
2. **URGENT**: Remplacer imports lucide-react
3. **IMPORTANT**: Lazy loading des sections
4. **IMPORTANT**: Optimiser Framer Motion
5. **MOYEN**: Code splitting avanc√©

## üìù Checklist de D√©ploiement

- [ ] Build en mode production
- [ ] V√©rifier que `NODE_ENV=production`
- [ ] Tester sur Lighthouse apr√®s d√©ploiement
- [ ] V√©rifier que GTM se charge en async
- [ ] Valider les Core Web Vitals
- [ ] Tester sur mobile (3G/4G)

## üîó Ressources

- [Next.js Performance](https://nextjs.org/docs/advanced-features/measuring-performance)
- [Web.dev Performance](https://web.dev/performance/)
- [Lighthouse CI](https://github.com/GoogleChrome/lighthouse-ci)

---

**Cr√©√© le**: 13 Octobre 2025  
**Derni√®re mise √† jour**: 13 Octobre 2025  
**Auteur**: OMA Digital Team
